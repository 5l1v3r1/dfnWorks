

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>modules.gen_output &mdash; dfnWorks 2.0.0 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="dfnWorks 2.0.0 documentation" href="../../index.html"/>
        <link rel="up" title="Module code" href="../index.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="../../index.html" class="fa fa-home"> dfnWorks</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../intro.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../intro.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro.html#import-dfnworks">Import dfnWorks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro.html#about-this-manual">About this  manual</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro.html#contributors">Contributors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro.html#acknowledgements">Acknowledgements</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../scripts.html">setup.py: compile the components of dfnWorks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../scripts.html#benchmark-py-test-dfnworks-using-one-or-more-benchamrks">benchmark.py: test dfnWorks using one or more benchamrks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../scripts.html#run-dfnworks-py-execute-a-single-run-of-dfnworks">run_dfnworks.py: execute a single run of dfnWorks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">dfnworks: dfnWorks python wrapper</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../modules.html#dfnworks-class">DFNWORKS class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../modules.html#dfnflow-method">dfnFlow method</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../modules.html#dfntrans-method">dfnTrans method</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">dfnWorks</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">Module code</a> &raquo;</li>
      
    <li>modules.gen_output</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <h1>Source code for modules.gen_output</h1><div class="highlight"><pre>
<span class="kn">import</span> <span class="nn">generator</span>
<span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">matplotlib.pylab</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="kn">import</span> <span class="n">FormatStrFormatter</span>
<span class="kn">from</span> <span class="nn">matplotlib.backends.backend_pdf</span> <span class="kn">import</span> <span class="n">PdfPages</span>
<span class="kn">import</span> <span class="nn">matplotlib.mlab</span> <span class="kn">as</span> <span class="nn">mlab</span>

<span class="k">def</span> <span class="nf">output_report</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">radiiFile</span> <span class="o">=</span> <span class="s">&#39;radii.dat&#39;</span><span class="p">,</span> <span class="n">famFile</span> <span class="o">=</span><span class="s">&#39;families.dat&#39;</span><span class="p">,</span> <span class="n">transFile</span><span class="o">=</span><span class="s">&#39;translations.dat&#39;</span><span class="p">,</span> <span class="n">rejectFile</span> <span class="o">=</span> <span class="s">&#39;rejections.dat&#39;</span><span class="p">,</span> <span class="n">output_name</span> <span class="o">=</span> <span class="s">&#39;&#39;</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Create PDF report of generator </span>
<span class="sd">	Notes</span>
<span class="sd">	1. Set the number of histogram buckets (bins) by changing numBuckets variable in his graphing functions</span>
<span class="sd">	2. Also change number of x-values used to plot lines by changing numXpoints variable in appropriate funcs</span>
<span class="sd">	3. Set show = True to show plots immediately and still make pdf</span>
<span class="sd">	4. NOTE future developers of this code should ass functionality for radiiList of size 0. </span>

<span class="sd">	&quot;&quot;&quot;</span>
	<span class="k">print</span> <span class="s">&#39;--&gt; Creating Report of DFN generation&#39;</span>
	<span class="n">families</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;all&#39;</span><span class="p">:[],</span> <span class="s">&#39;notRemoved&#39;</span><span class="p">:[]}</span> <span class="c">## families[&#39;all&#39;] contains all radii.   </span>
					       <span class="c">## families[&#39;notRemoved&#39;] contains all non-isolated fractures. </span>
					       <span class="c">##   Isolated fracs get removed from DFN and have &#39;R&#39; at end  </span>
					       <span class="c">##   of input file line</span>
					       <span class="c">## families[&#39;1&#39;,&#39;2&#39;,&#39;3&#39; etc] correspond to a polyFam object\</span>
	<span class="n">output_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_local_jobname</span> <span class="o">+</span> <span class="s">&#39;_output_report.pdf&#39;</span>
	<span class="k">print</span> <span class="s">&#39;Writing output into: &#39;</span><span class="p">,</span> <span class="n">output_name</span>
	<span class="n">outputPDF</span> <span class="o">=</span> <span class="n">PdfPages</span><span class="p">(</span><span class="n">output_name</span><span class="p">)</span> <span class="c">## TODO to make this cmd line option --&gt; outputPDF = PdfPages(sys.argv[5])</span>
	<span class="n">show</span> <span class="o">=</span> <span class="bp">False</span> <span class="c">## Set to true for showing plots immediately instead of having to open pdf. Still makes pdf</span>

	<span class="k">class</span> <span class="nc">polyFam</span><span class="p">:</span>
		<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">globFamNum</span><span class="p">,</span> <span class="n">radiiList</span><span class="p">,</span> <span class="n">distrib</span><span class="p">,</span> <span class="n">infoStr</span><span class="p">,</span> <span class="n">parameters</span><span class="p">):</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">globFamNum</span> <span class="o">=</span> <span class="n">globFamNum</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">radiiList</span> <span class="o">=</span> <span class="n">radiiList</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">distrib</span> <span class="o">=</span> <span class="n">distrib</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">infoStr</span> <span class="o">=</span> <span class="n">infoStr</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">parameters</span> <span class="o">=</span> <span class="n">parameters</span>

		<span class="k">def</span> <span class="nf">printPolyFam</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
			<span class="k">print</span><span class="p">(</span><span class="s">&quot;famNum:</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">globFamNum</span><span class="p">)</span>
			<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">radiiList:</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">radiiList</span><span class="p">)</span>
			<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">distrib:</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">distrib</span><span class="p">)</span>
			<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">infoStr:</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">infoStr</span><span class="p">)</span>
			<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">parameters:</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">)</span>
			<span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n\n</span><span class="s">&quot;</span><span class="p">)</span>
		       

	<span class="c">## Rejection File line format:   &quot;118424 Short Intersections&quot; --&gt; {&quot;Short Intersections&quot;: 118424}</span>
	<span class="k">def</span> <span class="nf">graphRejections</span><span class="p">():</span>
		<span class="n">rejects</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

		<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">rejectFile</span><span class="p">):</span>
			<span class="n">num</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[:</span><span class="n">line</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span> <span class="c">## number comes before first space in line</span>
			<span class="n">name</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="c">## name comes after first space</span>
			<span class="n">midSpaceIndex</span> <span class="o">=</span> <span class="mi">1</span>
			<span class="k">while</span> <span class="n">midSpaceIndex</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="ow">and</span> <span class="s">&quot; &quot;</span> <span class="ow">in</span> <span class="n">name</span><span class="p">[</span><span class="n">midSpaceIndex</span><span class="o">+</span><span class="mi">1</span><span class="p">:]:</span> <span class="c">## cut long names in half</span>
				<span class="n">midSpaceIndex</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">,</span> <span class="n">midSpaceIndex</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
			<span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">[:</span><span class="n">midSpaceIndex</span><span class="p">]</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="n">name</span><span class="p">[</span><span class="n">midSpaceIndex</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
			<span class="n">rejects</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">num</span>
		
		<span class="n">totalRejects</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">rejects</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span> 
		<span class="n">figWidth</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">rejects</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">*</span> <span class="mf">1.25</span> <span class="c">## make width 25% bigger than biggest val</span>
		<span class="n">labelOffset</span> <span class="o">=</span> <span class="n">figWidth</span> <span class="o">*</span> <span class="mf">0.02</span> <span class="k">if</span> <span class="n">figWidth</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mf">0.05</span>   
		<span class="n">offset</span> <span class="o">=</span> <span class="mi">2</span>
		<span class="n">h</span> <span class="o">=</span> <span class="mf">0.35</span>   <span class="c"># height of horiz bar (vertical thickness)</span>

		<span class="n">horizBar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rejects</span><span class="p">))</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span> <span class="n">rejects</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">height</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rejects</span><span class="p">))</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span> <span class="n">rejects</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&quot;Rejection Reasons&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="n">figWidth</span> <span class="k">if</span> <span class="n">figWidth</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">1</span><span class="p">)</span>        

		<span class="k">for</span> <span class="n">bar</span> <span class="ow">in</span> <span class="n">horizBar</span><span class="p">:</span>
			<span class="n">width</span> <span class="o">=</span> <span class="n">bar</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span>
			<span class="k">if</span> <span class="n">width</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
				<span class="n">label</span> <span class="o">=</span> <span class="s">&#39;{0:d}</span><span class="se">\n</span><span class="s">{1:.2f}%&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">width</span><span class="p">),</span> <span class="n">width</span> <span class="o">/</span> <span class="n">totalRejects</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span> <span class="n">label</span> <span class="o">=</span> <span class="mi">0</span>
			<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">bar</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span><span class="o">+</span><span class="n">labelOffset</span><span class="p">,</span> <span class="n">bar</span><span class="o">.</span><span class="n">get_y</span><span class="p">()</span><span class="o">+</span><span class="n">h</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

		<span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="mf">0.98</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">outputPDF</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s">&#39;pdf&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">show</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


	<span class="c">## Histogram making helper function for graphTranslations()</span>
	<span class="k">def</span> <span class="nf">transHist</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="n">allList</span><span class="p">,</span> <span class="n">unRemovedList</span><span class="p">):</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
		<span class="n">numBuckets</span> <span class="o">=</span> <span class="mi">20</span>
		<span class="n">minSize</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">allList</span><span class="p">)</span>
		<span class="n">maxSize</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">allList</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">allList</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">numBuckets</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="n">minSize</span><span class="p">,</span> <span class="n">maxSize</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
			 <span class="n">label</span><span class="o">=</span><span class="s">&#39;All Fractures</span><span class="se">\n</span><span class="s">(Connected and Unconnected&#39;</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">unRemovedList</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">numBuckets</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;r&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="n">minSize</span><span class="p">,</span> <span class="n">maxSize</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
			 <span class="n">label</span><span class="o">=</span><span class="s">&#39;Non-isolated fractures (connected)&#39;</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">prefix</span> <span class="o">+</span> <span class="s">&quot;-Position Distribution&quot;</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;Fracture Position (Spatial Coordinate)&quot;</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;Number of Fractures&quot;</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">&quot;upper center&quot;</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">outputPDF</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s">&#39;pdf&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">show</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

	<span class="c">## Graphs position of fractures as histogram for x, y and z dimensions</span>
	<span class="c">## Input file format:    Xpos Ypos Zpos (R) [R is optional, indicates it was removed due to isolation]</span>
	<span class="k">def</span> <span class="nf">graphTranslations</span><span class="p">():</span>
		<span class="n">xAll</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">xUnremoved</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">yAll</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">yUnremoved</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">zAll</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">zUnremoved</span> <span class="o">=</span> <span class="p">[]</span>
		
		<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">transFile</span><span class="p">):</span>
			<span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">)</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="n">xAll</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
				<span class="n">yAll</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
				<span class="n">zAll</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()))</span>
				<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">:</span>           <span class="c">## no &#39;R&#39; at end of line </span>
					<span class="n">xUnremoved</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
					<span class="n">yUnremoved</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
					<span class="n">zUnremoved</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()))</span>                 
			<span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
				<span class="k">continue</span>

		<span class="n">transHist</span><span class="p">(</span><span class="s">&#39;X&#39;</span><span class="p">,</span> <span class="n">xAll</span><span class="p">,</span> <span class="n">xUnremoved</span><span class="p">)</span>
		<span class="n">transHist</span><span class="p">(</span><span class="s">&#39;Y&#39;</span><span class="p">,</span> <span class="n">yAll</span><span class="p">,</span> <span class="n">yUnremoved</span><span class="p">)</span>
		<span class="n">transHist</span><span class="p">(</span><span class="s">&#39;Z&#39;</span><span class="p">,</span> <span class="n">zAll</span><span class="p">,</span> <span class="n">zUnremoved</span><span class="p">)</span>
		

	<span class="k">def</span> <span class="nf">collectFamilyInfo</span><span class="p">():</span>
		<span class="n">famObj</span> <span class="o">=</span> <span class="n">polyFam</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[],</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="p">{})</span>
		<span class="n">possibleParams</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;Mean&quot;</span><span class="p">,</span> <span class="s">&quot;Standard Deviation&quot;</span><span class="p">,</span> <span class="s">&quot;Alpha&quot;</span><span class="p">,</span> <span class="s">&quot;Lambda&quot;</span><span class="p">]</span>
		<span class="n">bounds</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;Minimum Radius&quot;</span><span class="p">,</span> <span class="s">&quot;Maximum Radius&quot;</span><span class="p">]</span>

		<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">famFile</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;&quot;</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">famObj</span><span class="o">.</span><span class="n">distrib</span> <span class="o">==</span> <span class="s">&quot;Constant&quot;</span><span class="p">:</span>
					<span class="n">famObj</span><span class="o">.</span><span class="n">infoStr</span> <span class="o">+=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Constant distribution, only contains one radius size.</span><span class="se">\n</span><span class="s">&quot;</span>\
							   <span class="s">&quot;No distribution graphs will be made for this family.&quot;</span>

				<span class="n">famObj</span> <span class="o">=</span> <span class="n">polyFam</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[],</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="p">{})</span> <span class="c">## create new famObj for next family</span>
			
			<span class="k">else</span><span class="p">:</span>   <span class="c">## append all info to info sting </span>
				<span class="n">famObj</span><span class="o">.</span><span class="n">infoStr</span> <span class="o">+=</span> <span class="n">line</span>
                        <span class="k">if</span> <span class="s">&quot;UserDefined Ellipse&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                            <span class="n">famNum</span> <span class="o">=</span> <span class="s">&#39;-2&#39;</span>
                            <span class="n">famObj</span><span class="o">.</span><span class="n">globFamNum</span> <span class="o">=</span> <span class="n">famNum</span>
                            <span class="n">families</span><span class="p">[</span><span class="n">famNum</span><span class="p">]</span> <span class="o">=</span> <span class="n">famObj</span>
		        <span class="k">if</span> <span class="s">&quot;UserDefined Rectangle&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                            <span class="n">famNum</span> <span class="o">=</span> <span class="s">&#39;-1&#39;</span>
                            <span class="n">famObj</span><span class="o">.</span><span class="n">globFamNum</span> <span class="o">=</span> <span class="n">famNum</span>
                            <span class="n">families</span><span class="p">[</span><span class="n">famNum</span><span class="p">]</span> <span class="o">=</span> <span class="n">famObj</span>
                        <span class="k">if</span> <span class="s">&quot;Global Family&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
				<span class="c">## input format:     Global Family 1</span>
				<span class="n">famNum</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s">&quot;y&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
				<span class="n">famObj</span><span class="o">.</span><span class="n">globFamNum</span> <span class="o">=</span> <span class="n">famNum</span>
				<span class="n">families</span><span class="p">[</span><span class="n">famNum</span><span class="p">]</span> <span class="o">=</span> <span class="n">famObj</span>
			<span class="k">elif</span> <span class="s">&quot;Distribution:&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
				<span class="c">## input format:     Distribution: &quot;distribution name&quot;</span>
				<span class="n">famObj</span><span class="o">.</span><span class="n">distrib</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s">&quot;:&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
			<span class="k">elif</span> <span class="s">&quot;:&quot;</span> <span class="ow">in</span> <span class="n">line</span> <span class="ow">and</span> <span class="n">line</span><span class="p">[:</span><span class="n">line</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s">&quot;:&quot;</span><span class="p">)]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="ow">in</span> <span class="n">possibleParams</span><span class="p">:</span>
				<span class="c">## if one of the distribution param names is in the line, </span>
				<span class="c">##   match the name to the value and store in parameters attribute</span>
				<span class="c">## Mean: 0.5 ----&gt; famObj.parameters[&quot;Mean&quot;] = 0.5</span>
				<span class="n">paramList</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;:&quot;</span><span class="p">)</span>
				<span class="n">famObj</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="n">paramList</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">paramList</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
			<span class="k">elif</span> <span class="s">&quot;:&quot;</span> <span class="ow">in</span> <span class="n">line</span> <span class="ow">and</span> <span class="n">line</span><span class="p">[:</span><span class="n">line</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s">&quot;:&quot;</span><span class="p">)]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="ow">in</span> <span class="n">bounds</span><span class="p">:</span>
				<span class="c">## get min/max radius &amp; convert 10m -&gt; 10</span>
				<span class="n">paramList</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;:&quot;</span><span class="p">)</span>            
				<span class="n">famObj</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="n">paramList</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">&quot;m&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">paramList</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>

			<span class="c">## ======== Jeffrey, this is where you can add the family building parser code ====== #</span>
			<span class="c">## elif &quot;:&quot; in line:</span>
			<span class="c">##          paramList = line.split(&quot;:&quot;)</span>
			<span class="c">##          family parameter name = paramList[0]</span>
			<span class="c">##          parameter value = paramList[1]</span>
			<span class="c">## </span>
			<span class="c">## Just add all necessary attributes to the polyFam class and you should be good to go</span>

		<span class="c">## Also add each object to global and not Removed if not empty</span>
		<span class="c">## input file&#39;s line format:   xRadius yRadius Family# Removed (Optional)</span>

		<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">radiiFile</span><span class="p">):</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="n">elems</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">)</span>
				<span class="n">radius</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">elems</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
				<span class="n">famNum</span> <span class="o">=</span> <span class="n">elems</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
				<span class="n">families</span><span class="p">[</span><span class="s">&#39;all&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span>
				<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">elems</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">:</span>              <span class="c">## len = 4 when &#39;R&#39; is on line</span>
					<span class="n">families</span><span class="p">[</span><span class="s">&#39;notRemoved&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">famNum</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">families</span><span class="p">:</span> 
					<span class="n">families</span><span class="p">[</span><span class="n">famNum</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                                        <span class="n">families</span><span class="p">[</span><span class="n">famNum</span><span class="p">]</span><span class="o">.</span><span class="n">radiiList</span> <span class="o">=</span> <span class="p">[</span><span class="n">radius</span><span class="p">]</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">families</span><span class="p">[</span><span class="n">famNum</span><span class="p">]</span><span class="o">.</span><span class="n">radiiList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span>
			<span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
				<span class="k">continue</span>

		<span class="k">for</span> <span class="n">fam</span> <span class="ow">in</span> <span class="n">families</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">fam</span> <span class="o">!=</span> <span class="s">&#39;all&#39;</span> <span class="ow">and</span> <span class="n">fam</span> <span class="o">!=</span> <span class="s">&#39;notRemoved&#39;</span><span class="p">:</span>
				<span class="k">pass</span> <span class="c"># families[fam].printPolyFam()</span>


	<span class="c">############# Histogram &amp; PDF ##############</span>
	<span class="c">## histogram of sizes (from data) and PDF (from input parameters</span>
	<span class="c">## returns histHeights (height of all hist bars) for plotting cdf</span>
	<span class="c">##         &amp; list of x values of binCenters (also for cdf)</span>
	<span class="k">def</span> <span class="nf">histAndPDF</span><span class="p">(</span><span class="n">radiiSizes</span><span class="p">,</span> <span class="n">pdfArray</span><span class="p">,</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">xVals</span><span class="p">):</span>
		<span class="n">numBuckets</span> <span class="o">=</span> <span class="mi">100</span>
		<span class="n">fig</span><span class="p">,</span> <span class="n">histo</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
		<span class="c">### fig = plt.figure(figsize=(8., 6.), dpi=500)  ## comment out if you dont want pdf</span>
		<span class="c">## histo = plt.ax_stack()</span>

		<span class="c">## plot hist, set xtick labels</span>
		<span class="n">histHeights</span><span class="p">,</span> <span class="n">binEdges</span><span class="p">,</span> <span class="n">patches</span> <span class="o">=</span> <span class="n">histo</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">radiiSizes</span><span class="p">,</span> <span class="n">numBuckets</span><span class="p">,</span> <span class="n">normed</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;r&#39;</span><span class="p">,</span>
									<span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;Empirical data&#39;</span><span class="p">)</span>
		<span class="n">binCenters</span> <span class="o">=</span> <span class="p">[((</span><span class="n">binEdges</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">+</span> <span class="n">binEdges</span><span class="p">[</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">binEdges</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="c">## need for cdf</span>
			     <span class="c">## ^ -1 to prevent Index Error when calculating last bin Center</span>
		<span class="n">histo</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">binEdges</span><span class="p">)</span>
		<span class="n">histo</span><span class="o">.</span><span class="n">locator_params</span><span class="p">(</span><span class="n">tight</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="n">nbins</span> <span class="o">=</span> <span class="n">numBuckets</span><span class="o">/</span><span class="mf">8.0</span><span class="p">)</span> <span class="c">## num of axis value labels</span>
		<span class="n">histo</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">FormatStrFormatter</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%0.1f</span><span class="s">&#39;</span><span class="p">))</span>
		
		<span class="c">## now plot pdf over histogram</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xVals</span><span class="p">,</span> <span class="n">pdfArray</span><span class="p">,</span> <span class="s">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;Analytical PDF from input parameters&#39;</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;Fracture Radius&quot;</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;Probability Density&quot;</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.87</span><span class="p">)</span>

		<span class="k">return</span> <span class="n">histHeights</span><span class="p">,</span> <span class="n">binCenters</span>

	<span class="c">############# CDF ##############</span>
	<span class="c">## 2 cdfs, analytical (from pdf from given mu and sigma) and empirical (from histogram)</span>
	<span class="k">def</span> <span class="nf">cdfs</span><span class="p">(</span><span class="n">histHeights</span><span class="p">,</span> <span class="n">binCenters</span><span class="p">,</span> <span class="n">pdf</span><span class="p">,</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">xVals</span><span class="p">):</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
		<span class="n">analyticCDF</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">pdf</span><span class="p">)</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">pdf</span><span class="p">)</span>      
		<span class="n">empiricalCDF</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">histHeights</span><span class="p">)</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">histHeights</span><span class="p">)</span> <span class="c">## need these to correspond to xVals</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xVals</span><span class="p">,</span> <span class="n">analyticCDF</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;Analytic CDF (from input)&#39;</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">binCenters</span><span class="p">,</span> <span class="n">empiricalCDF</span><span class="p">,</span> <span class="s">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;Empirical CDF (from data)&#39;</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&quot;CDF of Empirical Data &amp; Analytical PDF from Input Parameters&quot;</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">&quot;lower right&quot;</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;Fracture Size&quot;</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;Probability Density&quot;</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>

	<span class="c">############# Q &amp; Q  ##############</span>
	<span class="c">## histogram values (x) vs. analytical PDF values (y) &amp; a line showing ideal 1 to 1 ratio</span>
	<span class="k">def</span> <span class="nf">qq</span><span class="p">(</span><span class="n">trueVals</span><span class="p">,</span> <span class="n">histHeights</span><span class="p">):</span>
		<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
		<span class="n">qq</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">histHeights</span><span class="p">,</span> <span class="n">trueVals</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s">&#39;r&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s">&#39;o&#39;</span><span class="p">,</span> 
				 <span class="n">label</span><span class="o">=</span><span class="s">&quot;x=Empirical value</span><span class="se">\n</span><span class="s">y=Analtical PDF value&quot;</span><span class="p">)</span>
		<span class="n">minMax</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">trueVals</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">histHeights</span><span class="p">)]),</span>  <span class="c"># min of both axes</span>
			  <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="nb">max</span><span class="p">(</span><span class="n">trueVals</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">histHeights</span><span class="p">)])]</span>  <span class="c"># max of both axes</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">minMax</span><span class="p">,</span> <span class="n">minMax</span><span class="p">,</span> <span class="s">&#39;k-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;y/x = 1&quot;</span><span class="p">)</span> <span class="c">## 1 to 1 ratio for reference</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">&quot;lower right&quot;</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&quot;Q-Q Plot of Data vs.Analytical Distrbution At Same Point (Bin Center)&quot;</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;Probability Density of Data&quot;</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;Probability Density on Analytical PDF&quot;</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">lognormCDF</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
		<span class="k">return</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">scipy</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">erf</span><span class="p">(</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">sigma</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
	       
	<span class="k">def</span> <span class="nf">graphLognormal</span><span class="p">(</span><span class="n">famObj</span><span class="p">):</span>
		<span class="n">numXpoints</span> <span class="o">=</span> <span class="mi">1000</span>
		<span class="n">xmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">famObj</span><span class="o">.</span><span class="n">radiiList</span><span class="p">)</span> <span class="c">##parameters[&quot;Minimum Radius&quot;] Use list max because distrib doesnt always get</span>
		<span class="n">xmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">famObj</span><span class="o">.</span><span class="n">radiiList</span><span class="p">)</span> <span class="c">##parameters[&quot;Maximum Radius&quot;]   the desired max value.</span>
		<span class="n">xVals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">numXpoints</span><span class="p">)</span>
		<span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="n">famObj</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s">&quot;Mean&quot;</span><span class="p">],</span> <span class="n">famObj</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s">&quot;Standard Deviation&quot;</span><span class="p">]</span>
		<span class="n">normConstant</span> <span class="o">=</span> <span class="mf">1.0</span>
		<span class="k">try</span><span class="p">:</span>       
			<span class="n">normConstant</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">lognormCDF</span><span class="p">(</span><span class="n">xmax</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span> <span class="o">-</span> <span class="n">lognormCDF</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">))</span>
		<span class="k">except</span> <span class="ne">ZeroDivisionError</span><span class="p">:</span> <span class="c">## happens when there is only one fracture in family so ^ has 0 in denominator</span>
			<span class="k">pass</span>  
		<span class="n">lognormPDFVals</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="o">*</span> <span class="n">normConstant</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">lognorm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">xVals</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">mu</span><span class="p">)]</span>

		<span class="n">histHeights</span><span class="p">,</span> <span class="n">binCenters</span> <span class="o">=</span> <span class="n">histAndPDF</span><span class="p">(</span><span class="n">famObj</span><span class="o">.</span><span class="n">radiiList</span><span class="p">,</span> <span class="n">lognormPDFVals</span><span class="p">,</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">xVals</span><span class="p">)</span> 
		<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&quot;Histogram of Obtained Radii Sizes &amp; Lognormal Distribution PDF.&quot;</span>\
			  <span class="s">&quot;</span><span class="se">\n</span><span class="s">Family #&quot;</span> <span class="o">+</span> <span class="n">famObj</span><span class="o">.</span><span class="n">globFamNum</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">outputPDF</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s">&#39;pdf&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">show</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

		<span class="n">cdfs</span><span class="p">(</span><span class="n">histHeights</span><span class="p">,</span> <span class="n">binCenters</span><span class="p">,</span> <span class="n">lognormPDFVals</span><span class="p">,</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">xVals</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">outputPDF</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s">&#39;pdf&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">show</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

		<span class="n">trueVals</span> <span class="o">=</span> <span class="p">[</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">lognorm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">binCenters</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">mu</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">binCenters</span><span class="p">))]</span>
		<span class="n">qq</span><span class="p">(</span><span class="n">trueVals</span><span class="p">,</span> <span class="n">histHeights</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">outputPDF</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s">&#39;pdf&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">show</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
	  
	      
	<span class="k">def</span> <span class="nf">powLawPDF</span><span class="p">(</span><span class="n">normConst</span><span class="p">,</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
		<span class="k">return</span> <span class="n">normConst</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">xmin</span><span class="o">**</span><span class="n">a</span><span class="p">))</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="p">)</span> 

	<span class="k">def</span> <span class="nf">powLawCDF</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
		<span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span> <span class="p">(</span><span class="n">xmin</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">**</span><span class="n">a</span> <span class="p">)</span> 

	<span class="k">def</span> <span class="nf">graphTruncPowerLaw</span><span class="p">(</span><span class="n">famObj</span><span class="p">):</span>
		<span class="n">numBuckets</span> <span class="o">=</span> <span class="mi">100</span>
		<span class="n">numXpoints</span> <span class="o">=</span> <span class="mi">1000</span>
		<span class="n">alpha</span> <span class="o">=</span> <span class="n">famObj</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s">&quot;Alpha&quot;</span><span class="p">]</span>
		<span class="n">radiiSizes</span> <span class="o">=</span> <span class="n">famObj</span><span class="o">.</span><span class="n">radiiList</span>
		<span class="n">xmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">famObj</span><span class="o">.</span><span class="n">radiiList</span><span class="p">)</span> <span class="c">##parameters[&quot;Minimum Radius&quot;] Use list max because distrib doesnt always get</span>
		<span class="n">xmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">famObj</span><span class="o">.</span><span class="n">radiiList</span><span class="p">)</span> <span class="c">##parameters[&quot;Maximum Radius&quot;]   the desired max value.</span>
		<span class="n">xVals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">numXpoints</span><span class="p">)</span>
		<span class="n">normConst</span> <span class="o">=</span> <span class="mf">1.0</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">normConst</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">powLawCDF</span><span class="p">(</span><span class="n">xmax</span><span class="p">,</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span> <span class="o">-</span> <span class="n">powLawCDF</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">alpha</span><span class="p">))</span>
		<span class="k">except</span> <span class="ne">ZeroDivisionError</span><span class="p">:</span> <span class="c">## happens when there is only one fracture in family so ^ has 0 in denominator</span>
			<span class="k">pass</span>        
		<span class="n">powLawPDFVals</span> <span class="o">=</span> <span class="p">[</span><span class="n">powLawPDF</span><span class="p">(</span><span class="n">normConst</span><span class="p">,</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xVals</span><span class="p">]</span>

		<span class="n">histHeights</span><span class="p">,</span> <span class="n">binCenters</span> <span class="o">=</span> <span class="n">histAndPDF</span><span class="p">(</span><span class="n">radiiSizes</span><span class="p">,</span> <span class="n">powLawPDFVals</span><span class="p">,</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">xVals</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&quot;Histogram of Obtained Radii Sizes &amp; Truncated Power Law Distribution PDF.&quot;</span>\
			  <span class="s">&quot;</span><span class="se">\n</span><span class="s"> Family #&quot;</span> <span class="o">+</span> <span class="n">famObj</span><span class="o">.</span><span class="n">globFamNum</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">outputPDF</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s">&#39;pdf&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">show</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

		<span class="n">cdfs</span><span class="p">(</span><span class="n">histHeights</span><span class="p">,</span> <span class="n">binCenters</span><span class="p">,</span> <span class="n">powLawPDFVals</span><span class="p">,</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">xVals</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">outputPDF</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s">&#39;pdf&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">show</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

		<span class="n">trueVals</span> <span class="o">=</span> <span class="p">[</span><span class="n">powLawPDF</span><span class="p">(</span><span class="n">normConst</span><span class="p">,</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">binCenters</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">alpha</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">binCenters</span><span class="p">))]</span>

		<span class="n">qq</span><span class="p">(</span><span class="n">trueVals</span><span class="p">,</span> <span class="n">histHeights</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">outputPDF</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s">&#39;pdf&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">show</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>



	<span class="k">def</span> <span class="nf">expPDF</span><span class="p">(</span><span class="n">normConst</span><span class="p">,</span> <span class="n">eLambda</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
		<span class="k">return</span> <span class="n">normConst</span> <span class="o">*</span> <span class="n">eLambda</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">e</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">eLambda</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">expCDF</span><span class="p">(</span><span class="n">eLambda</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
		<span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">e</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">eLambda</span><span class="o">*</span><span class="n">x</span><span class="p">))</span>
		
	<span class="k">def</span> <span class="nf">graphExponential</span><span class="p">(</span><span class="n">famObj</span><span class="p">):</span>
		<span class="n">numXpoints</span> <span class="o">=</span> <span class="mi">1000</span>
		<span class="n">numBuckets</span> <span class="o">=</span> <span class="mi">100</span>
		<span class="n">radiiSizes</span> <span class="o">=</span> <span class="n">famObj</span><span class="o">.</span><span class="n">radiiList</span>
		<span class="n">eLambda</span> <span class="o">=</span> <span class="n">famObj</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s">&quot;Lambda&quot;</span><span class="p">]</span>
		<span class="n">xmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">famObj</span><span class="o">.</span><span class="n">radiiList</span><span class="p">)</span> <span class="c">##parameters[&quot;Minimum Radius&quot;] Use list max because distrib doesnt always get</span>
		<span class="n">xmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">famObj</span><span class="o">.</span><span class="n">radiiList</span><span class="p">)</span> <span class="c">##parameters[&quot;Maximum Radius&quot;]   the desired max value.</span>
		<span class="n">xVals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">numXpoints</span><span class="p">)</span>
		<span class="n">normConst</span> <span class="o">=</span> <span class="mf">1.0</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">normConst</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span> <span class="n">expCDF</span><span class="p">(</span><span class="n">eLambda</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span> <span class="o">-</span> <span class="n">expCDF</span><span class="p">(</span><span class="n">eLambda</span><span class="p">,</span> <span class="n">xmin</span><span class="p">)</span> <span class="p">)</span>
		<span class="k">except</span> <span class="ne">ZeroDivisionError</span><span class="p">:</span> <span class="c">## happens when there is only one fracture in family so ^ has 0 in denominator</span>
			<span class="k">pass</span>          
		<span class="n">expPDFVals</span> <span class="o">=</span> <span class="p">[</span><span class="n">expPDF</span><span class="p">(</span><span class="n">normConst</span><span class="p">,</span> <span class="n">eLambda</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xVals</span><span class="p">]</span>

		<span class="n">histHeights</span><span class="p">,</span> <span class="n">binCenters</span> <span class="o">=</span> <span class="n">histAndPDF</span><span class="p">(</span><span class="n">radiiSizes</span><span class="p">,</span> <span class="n">expPDFVals</span><span class="p">,</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">xVals</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&quot;Histogram of Obtained Radii Sizes &amp; Exponential Distribution PDF.&quot;</span>\
			  <span class="s">&quot;</span><span class="se">\n</span><span class="s">Family #&quot;</span> <span class="o">+</span> <span class="n">famObj</span><span class="o">.</span><span class="n">globFamNum</span><span class="p">)</span> 
		<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">outputPDF</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s">&#39;pdf&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">show</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

		<span class="n">cdfs</span><span class="p">(</span><span class="n">histHeights</span><span class="p">,</span> <span class="n">binCenters</span><span class="p">,</span> <span class="n">expPDFVals</span><span class="p">,</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">xVals</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">outputPDF</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s">&#39;pdf&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">show</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

		<span class="n">trueVals</span> <span class="o">=</span> <span class="p">[</span><span class="n">expPDF</span><span class="p">(</span><span class="n">normConst</span><span class="p">,</span> <span class="n">eLambda</span><span class="p">,</span> <span class="n">binCenters</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">binCenters</span><span class="p">))]</span>
		<span class="n">qq</span><span class="p">(</span><span class="n">trueVals</span><span class="p">,</span> <span class="n">histHeights</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">outputPDF</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s">&#39;pdf&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">show</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


	<span class="k">def</span> <span class="nf">graphConstant</span><span class="p">(</span><span class="n">famObj</span><span class="p">):</span>
		<span class="c">#print(&quot;  Family #&quot; + famObj.globFamNum + &quot; is a constant distribution and only contains one radius size.&quot;)</span>
		<span class="k">pass</span>

	<span class="k">def</span> <span class="nf">graphAllAndNotRemoved</span><span class="p">():</span>
		<span class="n">numBuckets</span> <span class="o">=</span> <span class="mi">50</span>
		<span class="n">allList</span> <span class="o">=</span> <span class="n">families</span><span class="p">[</span><span class="s">&#39;all&#39;</span><span class="p">]</span> 
		<span class="n">unRemovedList</span> <span class="o">=</span> <span class="n">families</span><span class="p">[</span><span class="s">&#39;notRemoved&#39;</span><span class="p">]</span>
		<span class="n">minSize</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">allList</span><span class="p">)</span>
		<span class="n">maxSize</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">allList</span><span class="p">)</span>
		<span class="c"># If constant fracture size, increase max so histogram is not a delta function</span>
		<span class="k">if</span> <span class="n">minSize</span> <span class="o">==</span> <span class="n">maxSize</span><span class="p">:</span>
			<span class="n">maxSize</span> <span class="o">+=</span> <span class="mf">1.0</span>
		<span class="n">twentiethOfWidth</span> <span class="o">=</span> <span class="p">(</span><span class="n">maxSize</span> <span class="o">-</span> <span class="n">minSize</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.05</span>
		<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
		<span class="n">histCount</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">patches</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">allList</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">numBuckets</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="n">minSize</span><span class="p">,</span> <span class="n">maxSize</span><span class="p">),</span> 
				  <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;All Fractures</span><span class="se">\n</span><span class="s">(Connected and Unconnected&#39;</span><span class="p">)</span>

		<span class="n">binWidth</span> <span class="o">=</span> <span class="n">bins</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">bins</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">figHeight</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">histCount</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.2</span> <span class="c">## need room to show vals above bars</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">bins</span><span class="p">)</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">locator_params</span><span class="p">(</span><span class="n">tight</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="n">nbins</span> <span class="o">=</span> <span class="n">numBuckets</span><span class="o">/</span><span class="mf">5.0</span><span class="p">)</span> <span class="c">## num of axis value labels</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">FormatStrFormatter</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%0.1f</span><span class="s">&#39;</span><span class="p">))</span>

		<span class="c">## if no fractures removed, there&#39;s no point in using the same 2 histograms, </span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">allList</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">unRemovedList</span><span class="p">):</span>
			<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">unRemovedList</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">numBuckets</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;r&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="n">minSize</span><span class="p">,</span> <span class="n">maxSize</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
				  <span class="n">label</span><span class="o">=</span><span class="s">&#39;Non-isolated fractures (connected)&#39;</span><span class="p">)</span>

		<span class="c">## Add y values above all non-zero histogram bars        </span>
		<span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">histCount</span><span class="p">,</span> <span class="n">bins</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">count</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
				<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">count</span><span class="p">),</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">count</span> <span class="o">+</span> <span class="p">(</span><span class="n">figHeight</span><span class="o">*</span><span class="mf">0.03</span><span class="p">)),</span> 
					    <span class="n">rotation</span><span class="o">=</span><span class="s">&#39;vertical&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s">&#39;bottom&#39;</span><span class="p">)</span>
		       
		<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">figHeight</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xmin</span><span class="o">=</span><span class="n">minSize</span><span class="o">-</span><span class="n">twentiethOfWidth</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="n">maxSize</span><span class="o">+</span><span class="n">twentiethOfWidth</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="mf">0.98</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&quot;Fractures Sizes From All Families&quot;</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;Fracture Radius&quot;</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;Number of Fractures&quot;</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">outputPDF</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s">&#39;pdf&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">show</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
			
		
	<span class="k">def</span> <span class="nf">graphDistribs</span><span class="p">():</span>
		<span class="n">famNum</span> <span class="o">=</span> <span class="mi">1</span>
		<span class="n">updateStr</span> <span class="o">=</span> <span class="s">&quot;Graphing Family #{} which contains {} fractures.&quot;</span>
		<span class="n">graphDistFuncs</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;Lognormal&quot;</span> <span class="p">:</span> <span class="n">graphLognormal</span><span class="p">,</span>              <span class="c">## dict of graph functions</span>
				  <span class="s">&quot;Truncated Power-Law&quot;</span> <span class="p">:</span> <span class="n">graphTruncPowerLaw</span><span class="p">,</span>
				  <span class="s">&quot;Exponential&quot;</span> <span class="p">:</span> <span class="n">graphExponential</span><span class="p">,</span>
				  <span class="s">&quot;Constant&quot;</span> <span class="p">:</span> <span class="n">graphConstant</span> <span class="p">}</span>
		
		<span class="k">try</span><span class="p">:</span> 
			<span class="k">while</span> <span class="n">famNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
				<span class="n">famObj</span> <span class="o">=</span> <span class="n">families</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">famNum</span><span class="p">)]</span>
				<span class="k">print</span><span class="p">(</span><span class="n">updateStr</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">famObj</span><span class="o">.</span><span class="n">globFamNum</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">famObj</span><span class="o">.</span><span class="n">radiiList</span><span class="p">)))</span>

				<span class="c">## give info string from families file its own figure</span>
				<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
				<span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">.</span><span class="mi">1</span><span class="p">,</span><span class="o">.</span><span class="mi">2</span><span class="p">,</span><span class="n">famObj</span><span class="o">.</span><span class="n">infoStr</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">))</span>
				<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">outputPDF</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s">&#39;pdf&#39;</span><span class="p">)</span>

				<span class="c">## then graph info </span>
				<span class="n">graphDistFuncs</span><span class="p">[</span><span class="n">famObj</span><span class="o">.</span><span class="n">distrib</span><span class="p">](</span><span class="n">famObj</span><span class="p">)</span> <span class="c">## families&#39; keys are strings</span>
				<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s">&quot;all&quot;</span><span class="p">)</span>
				<span class="n">famNum</span> <span class="o">+=</span> <span class="mi">1</span>
		<span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span> <span class="c">## throws key error when we&#39;ve finished the last family number</span>
			<span class="k">pass</span>


	
	
	<span class="n">collectFamilyInfo</span><span class="p">()</span>
	<span class="n">graphTranslations</span><span class="p">()</span>
	<span class="n">graphDistribs</span><span class="p">()</span>
	<span class="n">graphAllAndNotRemoved</span><span class="p">()</span>
	<span class="n">graphRejections</span><span class="p">()</span>

	<span class="n">outputPDF</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="c">#################### End dfnGen Functions ##########################</span>
</pre></div>

          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Jeffrey Hyman, Satish Karra, Nataliia Makedonska, Nathaniel Knapp.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'2.0.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>